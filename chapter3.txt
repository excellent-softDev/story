This is the updated chapter 3